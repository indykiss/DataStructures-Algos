
# Most frequent sys des Qs from FB and brief description

- Functional/ Non-functional requirements
- Capacity/ load estimation
- Data models
- Define APIs 
- Building block of distributed system
- Deep dive into a couple components possibly


# Design FB news feed

In the Design Facebook News Feed question, design the following key features and their APIs.

- Facebook users should see the news feed containing posts and statuses from their friends and pages that they have followed.
- They can post and like statuses that may contain text, images, and videos.
- They can send friend requests to other users and follow other pages.

Design Goals:
- Minimum latency
- High Availability
- Eventual Consistency (Due to CAP Theorem)
- Read-Heavy Service


Scale Estimations:
- One billion daily active users (DAUs)
- Ten billion news feed requests daily
On average:
- Each user posts 1 a day
- Each post is liked five times
- Each user has 200 friends
- Each user follows 100 pages


* Functional:
- Wall of posts. Updated frequently
- People can like posts
- Post/ add a post
- Post -> text, images, videos
- Posts are from friends of user

* Non-functional:
- Low latency / low lag
- High availability and eventual consistency, CAP theorem
- Scalable; partionability 
- Read-heavy vs write heavy 

Extended reqs:
- Group functionality, commenting, Fb stories

Estimations
- 100 read vs 1 write 
- 1 bil daily users 
- 1 post/ day
- 50 likes/ post 
- 200 friends per person 

Traffic: # of requests per day
1 b * 3 / day  = 3b newsfeed requests/ day
20 posts per newsfeed = 60B posts loaded / day 


Storage: 
360 * 1 bil = 360b posts/ year 
1 KB * 360 B = 360 TB / year 

* APIs: REST 
getUserFeed(api_dev_key, user_id, numOfPosts)
createPost(api_dev_key, user_id, content, imageLocations, videoLocations, numOfLikes)
editPost(api_dev_key, post.id, newContent, newImageLocations, newVideoLocations)
deletePost(..., post.id)
createUser(..., name, email, phoneNumber, age, location, profilePicture)

API dev key is a unique ID to allow access to the right data

Database

# Status search 
Facebook provides a search bar at the top of its page to enable its users to search posts, statuses, videos, and other forms of content posted by their friends and the pages they follow. 

In this question,
- Develop a service to enable the users to search the statuses posted on Facebook by their friends and followed pages.
- Consider that these statuses will only contain text for this particular question.

Design Goals: 
- Minimum latency, no significant lag while searching for the statuses.
- Highly available.
- Eventually consistent
- Our system will be read-heavy as more users will be searching on Facebook rather than posting statuses. Thus, the number of read requests will be far greater than write requests.

Scale Estimations
- On average, the system will have one billion daily active users
- Receive around five billion search requests daily
- About one billion statuses will be generated by the users per day.

* Data models:
- User table, posts table, userFriends table (user1, user2) 
- MySQL relational database (relationships, structured/ tabled data, scalable)

* excalidraw the application itself 


# Live commenting 

- Design the backend of a system that can enable real-time commenting on Facebook posts.
- The users should be able to see the new comments in real-time for the posts visible in front of their screen.

This problem is quite challenging, as users are continuously scrolling the news feed, and thus the posts that are visible in their view can change very frequently.

Scale Estimations: 
- Every minute, Facebook serves over 100 million pieces of content that may receive comments.
- In that same minute, users submit around a million comments that need to get routed to the correct viewers.


# Messaging app 
- Support 1:1 conversations between two users.
- Track the online or offline status of the users.

If time remains, discuss more complex features like Group conversations and Push notifications.


# Instagram

- Users can upload and share photos.
- They can follow other users.
- Like the photos posted on Instagram.
- Instagram users should get a scrollable feed of photos that are posted by the users they follow.


# Design Typeahead Suggestions
- Suggest the top ten search queries based on the characters already typed by the user in the search box.
- Assume query's popularity can be determined by the frequency of the query being searched in the past.


# Privacy settings
We can set different privacy levels for the Facebook posts we publish to be only visible to a specific set of users like public, friends, friends of friends, etc.

- Enable a user to specify the different levels of privacy for a post so that it is only visible to a particular set of users.
- Implement two levels of privacy, Public and Friends.


# Proximity server / find my friends 
- Users can add, update, and delete places.
- Given a location expressed as latitude and longitude, users can query all the nearby places within a given distance.

Consider: mobile battery, efficiency important 

# Design top N songs 
- Get the top N songs for a user over the past X days.
- Assume popularity of a song can be determined by the frequency of the song being listened to in the past.


# Design web crawler
Web Crawler scans the world wide web to download and index all the web pages to be made available for the search queries submitted by the users.

- Given a list of seed web pages, it should download all the web pages and index them for future retrieval.
- The service should handle duplicate web pages so that unique URLs are stored.

Design Goals:
- Highly scalable, as it needs to crawl the entire Web and fetch billions of web pages.
- Robot Exclusion protocol, allowing web admins to declare parts of their websites off-limits to crawlers.

Scale Estimations:
- Our System will be crawling about 25 billion web pages every two weeks.
- On average, each URL will be 512 bytes in size,
- And each page will be about 100 KB in size.